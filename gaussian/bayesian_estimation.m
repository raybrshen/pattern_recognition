% parameters: training samples, true covariance of the data which is assumed known,%             and initial guess of mean and covariance of the parameter% return: bayesian method estimated mean and covariancefunction [mean,cov] = bayesian_estimation(samples,sig)  % assume samples are of Gaussian distribution  % get the number of samples and dimension  [n,d] = size(samples);    % the initial guess affects bayesian estimation result  % - for convenience, set it to the first sample  %mean0 = (samples(1,:))';  mean0 = (mean(samples(1:floor(n/2),:)))';  cov0 = ones(3,3);    % bayesian estimation of the mean  % first get the maximum likelihood estimated mean  ml_mean = (sum(samples)./n)';  % combine with initial guess to get bayesian estimation  mean = cov0*inv(cov0+(sig./n))*ml_mean+(sig./n)*inv(cov0+(sig./n))*mean0;    % bayesian estimation of the covariance  % bias, replace (m) with (m-1) to get unbias estimation)  cov = cov0*inv(cov0+(sig./n))*(sig./n);end