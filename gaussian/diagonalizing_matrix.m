% parameters: random vectors and the covariance matrices of two classes% return: diagonalizing matrixfunction dm = diagonalizing_matrix(rv_1,rv_2,sig_1,sig_2)  % compute eigenvectors and eigenvalues of each covariance matrix  [eigvec_1,eigval_1] = eig(sig_1);  [eigvec_2,eigval_2] = eig(sig_2);  % diagonalizing class-1 data  z_1 = ((eigval_1^(-1/2))*(eigvec_1')*(rv_1'))';  z_2 = ((eigval_1^(-1/2))*(eigvec_1')*(rv_2'))';  % intermediate covariance matrix  % inter_cov = (eigval_1^(-1/2))*(eigvec_1')*sig_2*eigvec_1*(eigval_1^(-1/2));  inter_cov = cov(z_2);  [eigvec_3,eigval_3] = eig(inter_cov);  % diagonalizing matrix  dm = (eigvec_3')*(eigval_1^(-1/2))*(eigvec_1');end